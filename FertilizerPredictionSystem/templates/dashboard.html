<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fertilizer Prediction Dashboard</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- CSS -->
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: #0a0f1f;
      color: #ffffff;
    }

    /* Navbar */
    nav {
      background: linear-gradient(90deg, #007bff, #00eaff, #2aa6ff);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 40px;
      position: sticky;
      top: 0;
      z-index: 999;
    }
    nav .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #fff;
      text-shadow: 0 0 10px #00eaff;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 25px;
      margin: 0;
      padding: 0;
    }
    nav ul li a {
      text-decoration: none;
      color: #fff;
      font-weight: 600;
      transition: color 0.3s;
    }
    nav ul li a:hover {
      color: #00ff66;
    }

    header {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      color: #ffffff;
      padding: 40px 20px 20px;
      text-shadow: 0px 0px 12px #00eaff;
      
    }

    .dashboard {
      display: flex;
      justify-content: center;
      padding: 50px;
      max-width: 90%;
      /* max-height: 600px; */
      margin: auto;
      background: url('/static/bg9.jpeg') no-repeat center center/cover;
      background-color: rgba(0, 0, 0, 0.4); /* dark layer */
      background-blend-mode: overlay;    /* blends nicely */
      border-radius: 12px;
    }



    .card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 0 20px rgba(0, 234, 255, 0.2);
      animation: fadeIn 1s ease;
      text-align: center;
    }

    .card h3 {
      margin-bottom: 20px;
      color: #00eaff;
      font-size: 1.5rem;
      border-bottom: 2px solid #2aa6ff;
      padding-bottom: 8px;
    }

    .btn-custom {
      background: linear-gradient(90deg, #007bff, #00eaff, #2aa6ff);
      border: none;
      border-radius: 30px;
      padding: 12px 20px;
      font-size: 1rem;
      font-weight: bold;
      color: #ffffff;
      cursor: pointer;
      transition: 0.3s;
      margin-top: 20px;
      display: inline-block;
      text-decoration: none;
    }

    .btn-custom:hover {
      background: linear-gradient(90deg, #00ff66, #00eaff);
      box-shadow: 0 0 20px #00ff66;
      color: #0a0f1f;
    }

    .result-box {
      text-align: center;
      font-size: 1.2rem;
      font-weight: 600;
      padding: 20px;
      background: rgba(0, 255, 102, 0.1);
      border-radius: 12px;
      margin-top: 20px;
      border: 2px solid #00ff66;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(15px);}
      to {opacity: 1; transform: translateY(0);}
    }

    /* --- Live Weather CSS (integrated) --- */
    .weather-wrap {width:100%; display:grid; gap:18px}
    .search{ display:grid; grid-template-columns:1fr auto; gap:12px; }
    .input{ position:relative }
    input[type="text"]{
      width:60%; padding:14px 44px 14px 14px; border-radius:14px; border:none; outline:none;
      font-size:15px; color:#0b1732; background:rgba(255,255,255,.95);
    }
    .btn-weather{ border:none; border-radius:14px; padding:14px 18px; cursor:pointer; font-weight:400; 
      background:#00d1dc; color:#fff; transition:transform .1s ease; }
    .btn-weather:active{ transform:translateY(1px)}
    .secondary{ background:transparent; border:2px solid rgba(255,255,255,.7)}
    .results{ display:grid; gap:14px; margin-top:20px }
    .now{ display:grid; grid-template-columns:auto 1fr; gap:14px; align-items:center }
    .now .icon{ width:88px; height:88px }
    .stats{ display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-top:10px }
    .pill{ background:rgba(255,255,255,.2); padding:12px; border-radius:14px; text-align:center }
    .pill b{ display:block; font-size:1.05rem; color:#fff }
    .pill span{ font-size:.9rem; color:#eef }
    .spinner{ width:22px; height:22px; border-radius:50%; border:3px solid rgba(255,255,255,.4); border-top-color:#fff; 
      animation:spin 1s linear infinite; display:none; margin-left:6px }
    @keyframes spin{ to{ transform:rotate(360deg)} }
    .row{ display:flex; align-items:center; gap:10px; justify-content:center }


/* Floating Weather Widget */
.weather-container {
  position: fixed;
  bottom: 90px;   /* sits above chatbot */
  right: 90px;
  width: 280px;
  background: #0a1a3b;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(31, 218, 255, 0.3);
  padding: 15px;
  z-index: 998;
  font-size: 0.85rem;
}

.weather-container h3 {
  font-size: 1.1rem;
  color: #00eaff;
  margin-bottom: 12px;
  text-align: center;
  border-bottom: 2px solid #2aa6ff;
  padding-bottom: 6px;
}



    /* --- Chatbot CSS --- */
    .chat-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    .chat-container {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 350px;
      height: 500px;
      display: flex;
      flex-direction: column;
      background-color: #0a1a3b;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(31, 218, 255, 0.3);
      overflow: hidden;
      z-index: 999;
    }
    .hidden { display: none; }
    .chat-header { background-color: #3a3a3a; color: #fff; padding: 15px; text-align: center; }
    .chat-messages { flex-grow: 1; padding: 20px; overflow-y: auto; }
    .message { display: flex; align-items: flex-start; margin-bottom: 15px; }
    .message-content { padding: 10px; border-radius: 5px; max-width: 70%; }
    .user-message { flex-direction: row-reverse; }
    .user-message .message-content { background-color: #4a90e2; margin-right: 10px; }
    .bot-message .message-content { background-color: #3a3a3a; margin-left: 10px; }
    .profile-image { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; }
    .chat-input-container { display: flex; padding: 15px; background-color: #2a2a2a; }
    #user-input { flex-grow: 1; padding: 10px; border: 1px solid #4a4a4a; border-radius: 5px; font-size: 1rem; background-color: #3a3a3a; color: #e0e0e0; outline: none; }
    #send-button { padding: 10px 20px; background-color: #4a90e2; color: #fff; border: none; border-radius: 5px; margin-left: 10px; cursor: pointer; font-size: 1rem; }


    /* Footer Layout */
footer {
  background: #0a0f1f;
  color: #ffffff;
  padding: 30px 20px 15px;
  font-size: 0.9rem;
  border-top: 2px solid #2aa6ff;
}

.footer-container {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  max-width: 1100px;
  margin: auto;
  gap: 20px;
}

.footer-section {
  flex: 1;
  min-width: 250px;
}

.footer-section h4 {
  color: #00eaff;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.footer-section p,
.footer-section a {
  color: #ffffff;
  opacity: 0.85;
  text-decoration: none;
  font-size: 0.9rem;
}

.footer-section a:hover {
  color: #00ff66;
  text-decoration: underline;
}

.footer-bottom {
  text-align: center;
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid #2aa6ff;
  font-size: 0.85rem;
  opacity: 0.8;
}

  </style>
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="logo">üå± FertilizerSys</div>
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="/fertilizer_prediction/">Prediction</a></li>
      <li><a href="#weather">Weather</a></li>
      <li><a href="#footer">About</a></li>
      <li><a href="#footer">Contact</a></li>
      <li><a href="/logout/" style="background:#202858; padding:8px 14px; border-radius:20px; font-weight:600; color:#fff; transition:0.3s;">üö™ Logout</a></li>
    </ul>
  </nav>


  <!-- Header -->
  <header>Fertilizer Prediction Dashboard</header>

<!-- Dashboard -->
<div class="dashboard">
  <!-- Fertilizer Prediction -->
  <div class="card">
    <h3>Recommended Fertilizer</h3>
    {% if prediction %}
    <div class="result-box">üåø {{ prediction }}</div>
    {% else %}
    <p>No prediction available yet. Click below to enter soil details.</p>
    {% endif %}
    <a href="/fertilizer_prediction/" class="btn-custom">üîç Go to Prediction Form</a>
  </div>
</div>

<!-- Floating Weather -->
<div class="weather-container hidden" id="weather">
  <h3>üå§ Live Weather</h3>
  <div class="weather-wrap">
    <div class="search">
      <div class="input">
        <input id="q" type="text" placeholder="Enter location..." list="popular-cities" />
        <datalist id="popular-cities">
          <option value="Delhi"></option><option value="Mumbai"></option>
          <option value="London"></option><option value="New York"></option>
          <option value="Tokyo"></option><option value="Paris"></option>
        </datalist>
      </div>
      <button id="go" class="btn-weather">Check Weather</button>
    </div>
    <div class="row">
      <button id="geo" class="btn-weather secondary">üìç Use My Location</button>
      <div id="spin" class="spinner"></div>
    </div>
  </div>
  <div id="out" class="results"><p class="hint">Result will appear here.</p></div>
</div>

<button id="weather-toggle" class="chat-toggle" style="right: 90px;">üå§</button>



  <!-- Floating Chatbot -->
  <button id="chat-toggle" class="chat-toggle">üí¨</button>
  <div class="chat-container hidden" id="chat-container">
    <div class="chat-header"><h1>Chatbot ZiKi ü§ñ</h1></div>
    <div class="chat-messages" id="chat-messages"></div>
    <div class="chat-input-container">
      <input type="text" id="user-input" placeholder="Type your message...">
      <button id="send-button">Send</button>
    </div>
  </div>

  <footer>
  <div class="footer-container">
    <!-- Left: About -->
    <div class="footer-section">
      <h4>About</h4>
      <p>AI-driven fertilizer recommendation system helping farmers improve crop yield with data-driven insights.</p>
    </div>

    <!-- Middle: Quick Links -->
    <div class="footer-section">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="">üè† Home</a></li>
        <li><a href="/fertilizer_prediction/">üå± Prediction</a></li>
        <li><a href="#footer">‚ÑπÔ∏è About Us</a></li>
        <li><a href="#footer">üì© Contact</a></li>
      </ul>
    </div>

    <!-- Right: Contact -->
    <div class="footer-section" id="footer">
      <h4>Contact</h4>
      <p>üìç Location: India</p>
      <p>üìß Email: support@fertilizer-ai.com</p>
      <p>üìû Phone: +91 98765 43210</p>
    </div>
  </div>

  <div class="footer-bottom">
    <p>&copy; 2024 Fertilizer Prediction System | Designed with ‚ù§Ô∏è | All Rights Reserved</p>
  </div>
</footer>

  

  <script>

    document.getElementById("weather-toggle").addEventListener("click", () => {
  document.getElementById("weather").classList.toggle("hidden");
});


    /* --- Live Weather JS --- */
    const W_API_KEY = 'd7acdd2eed3d467eb82175524252608';
    const BASE = 'http://api.weatherapi.com/v1/current.json';
    const elQ = document.getElementById('q'), elGo = document.getElementById('go'),
          elOut = document.getElementById('out'), elSpin = document.getElementById('spin'),
          elGeo = document.getElementById('geo');
    const showSpinner = (on=true)=>{ elSpin.style.display = on ? 'inline-block' : 'none' };
    async function fetchWeather(query){
      const url = `${BASE}?key=${W_API_KEY}&q=${encodeURIComponent(query)}&aqi=yes`;
      const res = await fetch(url);
      const data = await res.json();
      if(data && data.error) throw new Error(data.error.message);
      return data;
    }
    function template(data){
      const { location, current } = data;
      return `<div class="now">
                <img class="icon" src="https:${current.condition.icon}" alt="${current.condition.text}" />
                <div><h2>${location.name}, ${location.country}</h2><div>${current.condition.text}</div></div>
              </div>
              <div class="stats">
                <div class="pill"><b>${current.temp_c}¬∞C</b><span>Temperature</span></div>
                <div class="pill"><b>${current.humidity}%</b><span>Humidity</span></div>
                <div class="pill"><b>${current.wind_kph} kph</b><span>Wind</span></div>
              </div>`;
    }
    async function handleSearch(query){
      if(!query) return;
      showSpinner(true); elOut.innerHTML = '<p class="hint">Fetching live weather‚Ä¶</p>';
      try{ elOut.innerHTML = template(await fetchWeather(query)); }
      catch(err){ elOut.innerHTML = `<p class="error">${err.message}</p>`; }
      finally{ showSpinner(false); }
    }
    elGo.addEventListener('click', ()=> handleSearch(elQ.value.trim()));
    elQ.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ handleSearch(elQ.value.trim()); }});
    elGeo.addEventListener('click', ()=>{ 
      navigator.geolocation?.getCurrentPosition(
        pos=> handleSearch(`${pos.coords.latitude},${pos.coords.longitude}`),
        err=> elOut.innerHTML = `<p class="error">${err.message}</p>`
      );
    });

    /* --- Chatbot JS --- */
    const API_KEY = "AIzaSyDPIDr5YfIB8AutCXhp4_W8LKqMWWWIi-g";  
    const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent";
    const chatMessages = document.getElementById('chat-messages'), userInput = document.getElementById('user-input'),
          sendButton = document.getElementById('send-button');
    async function generateResponse(prompt) {
      const response = await fetch(`${API_URL}?key=${API_KEY}`, {
        method: 'POST', headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
      });
      const data = await response.json(); return data.candidates[0].content.parts[0].text;
    }
    function addMessage(message, isUser) {
      const msg = document.createElement('div'); msg.classList.add('message', isUser ? 'user-message' : 'bot-message');
      const profile = document.createElement('img'); profile.classList.add('profile-image'); profile.src = isUser ? "/static/starboy.jpeg" : "/static/AI.jpeg";
      const content = document.createElement('div'); content.classList.add('message-content'); content.textContent = message;
      msg.appendChild(profile); msg.appendChild(content); chatMessages.appendChild(msg); chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    async function handleUserInput() {
      const text = userInput.value.trim(); if (!text) return;
      addMessage(text, true); userInput.value = ""; sendButton.disabled = true; userInput.disabled = true;
      try { addMessage(await generateResponse(text), false); }
      catch { addMessage("‚ö†Ô∏è Error: Could not get response. Try again!", false); }
      finally { sendButton.disabled = false; userInput.disabled = false; }
    }
    sendButton.addEventListener("click", handleUserInput);
    userInput.addEventListener("keypress", e => { if (e.key === "Enter") handleUserInput(); });
    document.getElementById("chat-toggle").addEventListener("click", () => {
      document.getElementById("chat-container").classList.toggle("hidden");
    });
  </script>
</body>
</html>

